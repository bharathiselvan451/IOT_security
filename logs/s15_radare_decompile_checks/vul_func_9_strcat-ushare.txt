[*] Binary protection state of ushare

  
  	No RELRO       No Canary found   NX disabled  No PIE       No RPATH     No RUNPATH   No Symbols


[*] Function strcat tear down of ushare

    ; assembly                               | /* r2dec pseudo code output */
                                             | /* /logs/firmware/unblob_extracted/firmware_extract/1180160-3904000.squashfs_v4_le_extract/usr/bin/ushare @ 0x4084c0 */
                                             | #include <stdint.h>
                                             |  
    ; (fcn) sym.buffer_append ()             | void buffer_append () {
    0x004084c0 lui gp, 6                     |     
    0x004084c4 addiu gp, gp, -0x5900         |     
    0x004084c8 addu gp, gp, t9               |     gp += t9;
    0x004084cc addiu sp, sp, -0x28           |     
    0x004084d0 sw ra, 0x24(sp)               |     *(var_24h) = ra;
    0x004084d4 sw s2, 0x20(sp)               |     *(var_20h) = s2;
    0x004084d8 sw s1, 0x1c(sp)               |     *(var_1ch) = s1;
    0x004084dc sw s0, 0x18(sp)               |     *(var_18h) = s0;
    0x004084e0 sw gp, 0x10(sp)               |     *(var_10h) = gp;
    0x004084e4 move s1, a0                   |     s1 = a0;
    0x004084e8 move s2, a1                   |     s2 = a1;
                                             |     if (a0 == 0) {
    0x004084ec beqz a0, 0x40858c             |         goto label_0;
                                             |     }
                                             |     if (a1 == 0) {
    0x004084f0 beqz a1, 0x40858c             |         goto label_0;
                                             |     }
    0x004084f4 nop                           |     
    0x004084f8 lw s0, (s1)                   |     s0 = *(s1);
    0x004084fc lw t9, -0x7d20(gp)            |     t9 = sym.imp.malloc;
    0x00408500 ori a0, zero, 0x8000          |     a0 = 0x8000;
    0x00408504 beqz s0, 0x4085a4             |     
                                             |     while (1) {
    0x00408508 lw t9, -0x7f70(gp)            |         t9 = sym.imp.strlen;
    0x0040850c move a0, s2                   |         a0 = s2;
    0x00408510 jalr t9                       |         t9 ();
    0x00408514 lw t0, 4(s1)                  |         t0 = *((s1 + 1));
    0x00408518 lw a2, 8(s1)                  |         a2 = *((s1 + 2));
    0x0040851c addu a3, t0, v0               |         a3 = t0 + v0;
    0x00408520 sll a1, a2, 1                 |         a1 = a2 << 1;
    0x00408524 addiu v0, a3, 1               |         v0 = a3 + 1;
    0x00408528 sltu a0, a1, v0               |         a0 = (a1 < v0) ? 1 : 0;
    0x0040852c sltu v1, a3, a2               |         v1 = (a3 < a2) ? 1 : 0;
    0x00408530 lw gp, 0x10(sp)               |         gp = *(var_10h);
                                             |         if (a0 != 0) {
    0x00408534 movz v0, a1, a0               |             v0 = a1;
                                             |         }
    0x00408538 move a1, v0                   |         a1 = v0;
    0x0040853c lw t9, -0x7e40(gp)            |         t9 = sym.imp.realloc;
    0x00408540 move a0, s0                   |         a0 = s0;
                                             |         if (v1 == 0) {
    0x00408544 bnez v1, 0x40855c             |             
    0x00408548 sw v0, 8(s1)                  |             *((s1 + 2)) = v0;
    0x0040854c jalr t9                       |             t9 ();
    0x00408550 lw gp, 0x10(sp)               |             gp = *(var_10h);
    0x00408554 move s0, v0                   |             s0 = v0;
    0x00408558 sw v0, (s1)                   |             *(s1) = v0;
                                             |         }
[31m    0x0040855c lw t9, -0x7dbc(gp)            |         t9 = sym.imp.strcat;[0m
    0x00408560 move a0, s0                   |         a0 = s0;
    0x00408564 move a1, s2                   |         a1 = s2;
    0x00408568 jalr t9                       |         t9 ();
    0x0040856c lw gp, 0x10(sp)               |         gp = *(var_10h);
    0x00408570 lw t9, -0x7f70(gp)            |         t9 = sym.imp.strlen;
    0x00408574 move a0, s2                   |         a0 = s2;
    0x00408578 jalr t9                       |         t9 ();
    0x0040857c lw t2, 4(s1)                  |         t2 = *((s1 + 1));
    0x00408580 lw gp, 0x10(sp)               |         gp = *(var_10h);
    0x00408584 addu t1, t2, v0               |         t1 = t2 + v0;
    0x00408588 sw t1, 4(s1)                  |         *((s1 + 1)) = t1;
                                             | label_0:
    0x0040858c lw ra, 0x24(sp)               |         ra = *(var_24h);
    0x00408590 lw s2, 0x20(sp)               |         s2 = *(var_20h);
    0x00408594 lw s1, 0x1c(sp)               |         s1 = *(var_1ch);
    0x00408598 lw s0, 0x18(sp)               |         s0 = *(var_18h);
    0x0040859c addiu sp, sp, 0x28            |         
    0x004085a0 jr ra                         |         return v0;
    0x004085a4 ori v0, zero, 0x8000          |         v0 = 0x8000;
    0x004085a8 sw v0, 8(s1)                  |         *((s1 + 2)) = v0;
    0x004085ac jalr t9                       |         t9 ();
    0x004085b0 move a1, zero                 |         a1 = 0;
    0x004085b4 lw gp, 0x10(sp)               |         gp = *(var_10h);
    0x004085b8 move a0, v0                   |         a0 = v0;
    0x004085bc lw a2, 8(s1)                  |         a2 = *((s1 + 2));
    0x004085c0 lw t9, -0x7e80(gp)            |         t9 = sym.imp.memset;
    0x004085c4 sw v0, (s1)                   |         *(s1) = v0;
    0x004085c8 jalr t9                       |         t9 ();
    0x004085cc lw gp, 0x10(sp)               |         gp = *(var_10h);
    0x004085d0 lw s0, (s1)                   |         s0 = *(s1);
    0x004085d4 b 0x408508                    |         
                                             |     }
    0x004085d8 nop                           |     
                                             | }
    ; assembly                               | /* r2dec pseudo code output */
                                             | /* /logs/firmware/unblob_extracted/firmware_extract/1180160-3904000.squashfs_v4_le_extract/usr/bin/ushare @ 0x4085dc */
                                             | #include <stdint.h>
                                             |  
    ; (fcn) sym.buffer_appendf ()            | void buffer_appendf () {
    0x004085dc lui gp, 6                     |     
    0x004085e0 addiu gp, gp, -0x5a1c         |     
    0x004085e4 addu gp, gp, t9               |     gp += t9;
    0x004085e8 addiu sp, sp, -0x7fe0         |     
    0x004085ec sw ra, 0x7fdc(sp)             |     *(var_7fdch) = ra;
    0x004085f0 sw s4, 0x7fd8(sp)             |     *(var_7fd8h) = s4;
    0x004085f4 sw s3, 0x7fd4(sp)             |     *(var_7fd4h) = s3;
    0x004085f8 sw s2, 0x7fd0(sp)             |     *(var_7fd0h) = s2;
    0x004085fc sw s1, 0x7fcc(sp)             |     *(var_7fcch) = s1;
    0x00408600 sw s0, 0x7fc8(sp)             |     *(var_7fc8h) = s0;
    0x00408604 addiu sp, sp, -0x50           |     
    0x00408608 sw gp, 0x10(sp)               |     *((sp + 4)) = gp;
    0x0040860c ori v1, zero, 0x803c          |     v1 = 0x803c;
    0x00408610 move s1, a1                   |     s1 = a1;
    0x00408614 ori a1, zero, 0x8038          |     a1 = 0x8038;
    0x00408618 move s2, a0                   |     s2 = a0;
    0x0040861c addu v0, v1, sp               |     v0 = v1 + sp;
    0x00408620 addu a0, a1, sp               |     a0 = a1 + sp;
    0x00408624 sw a2, (a0)                   |     *(a0) = a2;
    0x00408628 sw a3, (v0)                   |     *(v0) = a3;
                                             |     if (s2 == 0) {
    0x0040862c beqz s2, 0x4086f8             |         goto label_1;
                                             |     }
    0x00408630 ori t0, zero, 0x8038          |     t0 = 0x8038;
                                             |     if (s1 == 0) {
    0x00408634 beqz s1, 0x4086f8             |         goto label_1;
                                             |     }
    0x00408638 move a2, s1                   |     a2 = s1;
    0x0040863c lw t9, -0x7d2c(gp)            |     t9 = sym.imp.vsnprintf;
    0x00408640 addu s4, sp, t0               |     s4 = sp + t0;
    0x00408644 move a3, s4                   |     a3 = s4;
    0x00408648 addiu a0, sp, 0x18            |     a0 = sp + 0x18;
    0x0040864c ori a1, zero, 0x8000          |     a1 = 0x8000;
    0x00408650 jalr t9                       |     t9 ();
    0x00408654 addiu a3, zero, 0x7fff        |     a3 = 0x7fff;
    0x00408658 slt a2, a3, v0                |     a2 = (a3 < v0) ? 1 : 0;
    0x0040865c lw gp, 0x10(sp)               |     gp = *(var_10h);
    0x00408660 addiu s0, v0, 1               |     s0 = v0 + 1;
                                             |     if (a2 != 0) {
    0x00408664 bnez a2, 0x40871c             |         goto label_2;
                                             |     }
    0x00408668 lw s0, (s2)                   |     s0 = *(s2);
    0x0040866c addiu s1, sp, 0x18            |     s1 = sp + 0x18;
    0x00408670 beqz s0, 0x408818             |     
                                             |     while (1) {
    0x00408674 lw t9, -0x7f70(gp)            |         t9 = sym.imp.strlen;
    0x00408678 move a0, s1                   |         a0 = s1;
    0x0040867c jalr t9                       |         t9 ();
    0x00408680 lw t8, 4(s2)                  |         t8 = *((s2 + 1));
    0x00408684 lw a0, 8(s2)                  |         a0 = *((s2 + 2));
    0x00408688 addu v1, t8, v0               |         v1 = t8 + v0;
    0x0040868c sltu s4, v1, a0               |         s4 = (v1 < a0) ? 1 : 0;
    0x00408690 lw gp, 0x10(sp)               |         gp = *(var_10h);
    0x00408694 sll ra, a0, 1                 |         ra = a0 << 1;
                                             |         if (s4 == 0) {
    0x00408698 bnez s4, 0x4086c8             |             
    0x0040869c addiu v0, v1, 1               |             v0 = v1 + 1;
    0x004086a0 sltu a1, ra, v0               |             a1 = (ra < v0) ? 1 : 0;
                                             |             if (a1 == 0) {
    0x004086a4 movn ra, v0, a1               |                 ra = v0;
                                             |             }
    0x004086a8 lw t9, -0x7e40(gp)            |             t9 = sym.imp.realloc;
    0x004086ac move a1, ra                   |             a1 = ra;
    0x004086b0 sw ra, 8(s2)                  |             *((s2 + 2)) = ra;
    0x004086b4 move a0, s0                   |             a0 = s0;
    0x004086b8 jalr t9                       |             t9 ();
    0x004086bc lw gp, 0x10(sp)               |             gp = *(var_10h);
    0x004086c0 move s0, v0                   |             s0 = v0;
    0x004086c4 sw v0, (s2)                   |             *(s2) = v0;
                                             |         }
[31m    0x004086c8 lw t9, -0x7dbc(gp)            |         t9 = sym.imp.strcat;[0m
    0x004086cc move a0, s0                   |         a0 = s0;
    0x004086d0 move a1, s1                   |         a1 = s1;
    0x004086d4 jalr t9                       |         t9 ();
    0x004086d8 lw gp, 0x10(sp)               |         gp = *(var_10h);
    0x004086dc lw t9, -0x7f70(gp)            |         t9 = sym.imp.strlen;
    0x004086e0 move a0, s1                   |         a0 = s1;
    0x004086e4 jalr t9                       |         t9 ();
    0x004086e8 lw a0, 4(s2)                  |         a0 = *((s2 + 1));
    0x004086ec lw gp, 0x10(sp)               |         gp = *(var_10h);
    0x004086f0 addu v1, a0, v0               |         v1 = a0 + v0;
    0x004086f4 sw v1, 4(s2)                  |         *((s2 + 1)) = v1;
                                             | label_1:
    0x004086f8 addiu sp, sp, 0x50            |         
    0x004086fc lw ra, 0x7fdc(sp)             |         ra = *(var_7fdch);
    0x00408700 lw s4, 0x7fd8(sp)             |         s4 = *(var_7fd8h);
    0x00408704 lw s3, 0x7fd4(sp)             |         s3 = *(var_7fd4h);
    0x00408708 lw s2, 0x7fd0(sp)             |         s2 = *(var_7fd0h);
    0x0040870c lw s1, 0x7fcc(sp)             |         s1 = *(var_7fcch);
    0x00408710 lw s0, 0x7fc8(sp)             |         s0 = *(var_7fc8h);
    0x00408714 addiu sp, sp, 0x7fe0          |         
    0x00408718 jr ra                         |         return v0;
                                             | label_2:
    0x0040871c lw t9, -0x7d20(gp)            |         t9 = sym.imp.malloc;
    0x00408720 move a0, s0                   |         a0 = s0;
    0x00408724 jalr t9                       |         t9 ();
    0x00408728 move a1, s0                   |         a1 = s0;
    0x0040872c lw gp, 0x10(sp)               |         gp = *(var_10h);
    0x00408730 move s3, v0                   |         s3 = v0;
    0x00408734 move a0, v0                   |         a0 = v0;
    0x00408738 move a2, s1                   |         a2 = s1;
    0x0040873c lw t9, -0x7d2c(gp)            |         t9 = sym.imp.vsnprintf;
    0x00408740 move a3, s4                   |         a3 = s4;
    0x00408744 jalr t9                       |         t9 ();
    0x00408748 lw gp, 0x10(sp)               |         gp = *(var_10h);
                                             |         if (s3 != 0) {
    0x0040874c beqz s3, 0x4087e4             |             
    0x00408750 nop                           |             
    0x00408754 lw s0, (s2)                   |             s0 = *(s2);
    0x00408758 ori t1, zero, 0x8000          |             t1 = 0x8000;
                                             |             if (s0 == 0) {
    0x0040875c beqz s0, 0x408858             |                 goto label_3;
                                             |             }
                                             | label_0:
    0x00408760 lw t9, -0x7f70(gp)            |             t9 = sym.imp.strlen;
    0x00408764 move a0, s3                   |             a0 = s3;
    0x00408768 jalr t9                       |             t9 ();
    0x0040876c lw t3, 4(s2)                  |             t3 = *((s2 + 1));
    0x00408770 lw a0, 8(s2)                  |             a0 = *((s2 + 2));
    0x00408774 addu v1, t3, v0               |             v1 = t3 + v0;
    0x00408778 sltu t2, v1, a0               |             t2 = (v1 < a0) ? 1 : 0;
    0x0040877c lw gp, 0x10(sp)               |             gp = *(var_10h);
    0x00408780 sll t4, a0, 1                 |             t4 = a0 << 1;
                                             |             if (t2 == 0) {
    0x00408784 bnez t2, 0x4087b4             |                 
    0x00408788 addiu t5, v1, 1               |                 t5 = v1 + 1;
    0x0040878c sltu t6, t4, t5               |                 t6 = (t4 < t5) ? 1 : 0;
    0x00408790 move a0, s0                   |                 a0 = s0;
                                             |                 if (t6 == 0) {
    0x00408794 movn t4, t5, t6               |                     t4 = t5;
                                             |                 }
    0x00408798 lw t9, -0x7e40(gp)            |                 t9 = sym.imp.realloc;
    0x0040879c move a1, t4                   |                 a1 = t4;
    0x004087a0 sw t4, 8(s2)                  |                 *((s2 + 2)) = t4;
    0x004087a4 jalr t9                       |                 t9 ();
    0x004087a8 lw gp, 0x10(sp)               |                 gp = *(var_10h);
    0x004087ac move s0, v0                   |                 s0 = v0;
    0x004087b0 sw v0, (s2)                   |                 *(s2) = v0;
                                             |             }
[31m    0x004087b4 lw t9, -0x7dbc(gp)            |             t9 = sym.imp.strcat;[0m
    0x004087b8 move a0, s0                   |             a0 = s0;
    0x004087bc move a1, s3                   |             a1 = s3;
    0x004087c0 jalr t9                       |             t9 ();
    0x004087c4 lw gp, 0x10(sp)               |             gp = *(var_10h);
    0x004087c8 lw t9, -0x7f70(gp)            |             t9 = sym.imp.strlen;
    0x004087cc move a0, s3                   |             a0 = s3;
    0x004087d0 jalr t9                       |             t9 ();
    0x004087d4 lw s1, 4(s2)                  |             s1 = *((s2 + 1));
    0x004087d8 lw gp, 0x10(sp)               |             gp = *(var_10h);
    0x004087dc addu t7, s1, v0               |             t7 = s1 + v0;
    0x004087e0 sw t7, 4(s2)                  |             *((s2 + 1)) = t7;
                                             |         }
    0x004087e4 lw t9, -0x7fc0(gp)            |         t9 = sym.imp.free;
    0x004087e8 move a0, s3                   |         a0 = s3;
    0x004087ec jalr t9                       |         t9 ();
    0x004087f0 lw gp, 0x10(sp)               |         gp = *(var_10h);
    0x004087f4 addiu sp, sp, 0x50            |         
    0x004087f8 lw ra, 0x7fdc(sp)             |         ra = *(var_7fdch);
    0x004087fc lw s4, 0x7fd8(sp)             |         s4 = *(var_7fd8h);
    0x00408800 lw s3, 0x7fd4(sp)             |         s3 = *(var_7fd4h);
    0x00408804 lw s2, 0x7fd0(sp)             |         s2 = *(var_7fd0h);
    0x00408808 lw s1, 0x7fcc(sp)             |         s1 = *(var_7fcch);
    0x0040880c lw s0, 0x7fc8(sp)             |         s0 = *(var_7fc8h);
    0x00408810 addiu sp, sp, 0x7fe0          |         
    0x00408814 jr ra                         |         return v0;
    0x00408818 lw t9, -0x7d20(gp)            |         t9 = sym.imp.malloc;
    0x0040881c ori s3, zero, 0x8000          |         s3 = 0x8000;
    0x00408820 ori a0, zero, 0x8000          |         a0 = 0x8000;
    0x00408824 sw s3, 8(s2)                  |         *((s2 + 2)) = s3;
    0x00408828 jalr t9                       |         t9 ();
    0x0040882c move a1, zero                 |         a1 = 0;
    0x00408830 lw gp, 0x10(sp)               |         gp = *(var_10h);
    0x00408834 move a0, v0                   |         a0 = v0;
    0x00408838 lw a2, 8(s2)                  |         a2 = *((s2 + 2));
    0x0040883c lw t9, -0x7e80(gp)            |         t9 = sym.imp.memset;
    0x00408840 sw v0, (s2)                   |         *(s2) = v0;
    0x00408844 jalr t9                       |         t9 ();
    0x00408848 lw gp, 0x10(sp)               |         gp = *(var_10h);
    0x0040884c lw s0, (s2)                   |         s0 = *(s2);
    0x00408850 b 0x408674                    |         
                                             |     }
    0x00408854 nop                           |     
                                             | label_3:
    0x00408858 lw t9, -0x7d20(gp)            |     t9 = sym.imp.malloc;
    0x0040885c sw t1, 8(s2)                  |     *((s2 + 2)) = t1;
    0x00408860 ori a0, zero, 0x8000          |     a0 = 0x8000;
    0x00408864 jalr t9                       |     t9 ();
    0x00408868 move a1, zero                 |     a1 = 0;
    0x0040886c lw gp, 0x10(sp)               |     gp = *(var_10h);
    0x00408870 move a0, v0                   |     a0 = v0;
    0x00408874 lw a2, 8(s2)                  |     a2 = *((s2 + 2));
    0x00408878 lw t9, -0x7e80(gp)            |     t9 = sym.imp.memset;
    0x0040887c sw v0, (s2)                   |     *(s2) = v0;
    0x00408880 jalr t9                       |     t9 ();
    0x00408884 lw gp, 0x10(sp)               |     gp = *(var_10h);
    0x00408888 lw s0, (s2)                   |     s0 = *(s2);
    0x0040888c b 0x408760                    |     goto label_0;
    0x00408890 nop                           |     
                                             | }
    ; assembly                               | /* r2dec pseudo code output */
                                             | /* /logs/firmware/unblob_extracted/firmware_extract/1180160-3904000.squashfs_v4_le_extract/usr/bin/ushare @ 0x4085dc */
                                             | #include <stdint.h>
                                             |  
    ; (fcn) sym.buffer_appendf ()            | void buffer_appendf () {
    0x004085dc lui gp, 6                     |     
    0x004085e0 addiu gp, gp, -0x5a1c         |     
    0x004085e4 addu gp, gp, t9               |     gp += t9;
    0x004085e8 addiu sp, sp, -0x7fe0         |     
    0x004085ec sw ra, 0x7fdc(sp)             |     *(var_7fdch) = ra;
    0x004085f0 sw s4, 0x7fd8(sp)             |     *(var_7fd8h) = s4;
    0x004085f4 sw s3, 0x7fd4(sp)             |     *(var_7fd4h) = s3;
    0x004085f8 sw s2, 0x7fd0(sp)             |     *(var_7fd0h) = s2;
    0x004085fc sw s1, 0x7fcc(sp)             |     *(var_7fcch) = s1;
    0x00408600 sw s0, 0x7fc8(sp)             |     *(var_7fc8h) = s0;
    0x00408604 addiu sp, sp, -0x50           |     
    0x00408608 sw gp, 0x10(sp)               |     *((sp + 4)) = gp;
    0x0040860c ori v1, zero, 0x803c          |     v1 = 0x803c;
    0x00408610 move s1, a1                   |     s1 = a1;
    0x00408614 ori a1, zero, 0x8038          |     a1 = 0x8038;
    0x00408618 move s2, a0                   |     s2 = a0;
    0x0040861c addu v0, v1, sp               |     v0 = v1 + sp;
    0x00408620 addu a0, a1, sp               |     a0 = a1 + sp;
    0x00408624 sw a2, (a0)                   |     *(a0) = a2;
    0x00408628 sw a3, (v0)                   |     *(v0) = a3;
                                             |     if (s2 == 0) {
    0x0040862c beqz s2, 0x4086f8             |         goto label_1;
                                             |     }
    0x00408630 ori t0, zero, 0x8038          |     t0 = 0x8038;
                                             |     if (s1 == 0) {
    0x00408634 beqz s1, 0x4086f8             |         goto label_1;
                                             |     }
    0x00408638 move a2, s1                   |     a2 = s1;
    0x0040863c lw t9, -0x7d2c(gp)            |     t9 = sym.imp.vsnprintf;
    0x00408640 addu s4, sp, t0               |     s4 = sp + t0;
    0x00408644 move a3, s4                   |     a3 = s4;
    0x00408648 addiu a0, sp, 0x18            |     a0 = sp + 0x18;
    0x0040864c ori a1, zero, 0x8000          |     a1 = 0x8000;
    0x00408650 jalr t9                       |     t9 ();
    0x00408654 addiu a3, zero, 0x7fff        |     a3 = 0x7fff;
    0x00408658 slt a2, a3, v0                |     a2 = (a3 < v0) ? 1 : 0;
    0x0040865c lw gp, 0x10(sp)               |     gp = *(var_10h);
    0x00408660 addiu s0, v0, 1               |     s0 = v0 + 1;
                                             |     if (a2 != 0) {
    0x00408664 bnez a2, 0x40871c             |         goto label_2;
                                             |     }
    0x00408668 lw s0, (s2)                   |     s0 = *(s2);
    0x0040866c addiu s1, sp, 0x18            |     s1 = sp + 0x18;
    0x00408670 beqz s0, 0x408818             |     
                                             |     while (1) {
    0x00408674 lw t9, -0x7f70(gp)            |         t9 = sym.imp.strlen;
    0x00408678 move a0, s1                   |         a0 = s1;
    0x0040867c jalr t9                       |         t9 ();
    0x00408680 lw t8, 4(s2)                  |         t8 = *((s2 + 1));
    0x00408684 lw a0, 8(s2)                  |         a0 = *((s2 + 2));
    0x00408688 addu v1, t8, v0               |         v1 = t8 + v0;
    0x0040868c sltu s4, v1, a0               |         s4 = (v1 < a0) ? 1 : 0;
    0x00408690 lw gp, 0x10(sp)               |         gp = *(var_10h);
    0x00408694 sll ra, a0, 1                 |         ra = a0 << 1;
                                             |         if (s4 == 0) {
    0x00408698 bnez s4, 0x4086c8             |             
    0x0040869c addiu v0, v1, 1               |             v0 = v1 + 1;
    0x004086a0 sltu a1, ra, v0               |             a1 = (ra < v0) ? 1 : 0;
                                             |             if (a1 == 0) {
    0x004086a4 movn ra, v0, a1               |                 ra = v0;
                                             |             }
    0x004086a8 lw t9, -0x7e40(gp)            |             t9 = sym.imp.realloc;
    0x004086ac move a1, ra                   |             a1 = ra;
    0x004086b0 sw ra, 8(s2)                  |             *((s2 + 2)) = ra;
    0x004086b4 move a0, s0                   |             a0 = s0;
    0x004086b8 jalr t9                       |             t9 ();
    0x004086bc lw gp, 0x10(sp)               |             gp = *(var_10h);
    0x004086c0 move s0, v0                   |             s0 = v0;
    0x004086c4 sw v0, (s2)                   |             *(s2) = v0;
                                             |         }
[31m    0x004086c8 lw t9, -0x7dbc(gp)            |         t9 = sym.imp.strcat;[0m
    0x004086cc move a0, s0                   |         a0 = s0;
    0x004086d0 move a1, s1                   |         a1 = s1;
    0x004086d4 jalr t9                       |         t9 ();
    0x004086d8 lw gp, 0x10(sp)               |         gp = *(var_10h);
    0x004086dc lw t9, -0x7f70(gp)            |         t9 = sym.imp.strlen;
    0x004086e0 move a0, s1                   |         a0 = s1;
    0x004086e4 jalr t9                       |         t9 ();
    0x004086e8 lw a0, 4(s2)                  |         a0 = *((s2 + 1));
    0x004086ec lw gp, 0x10(sp)               |         gp = *(var_10h);
    0x004086f0 addu v1, a0, v0               |         v1 = a0 + v0;
    0x004086f4 sw v1, 4(s2)                  |         *((s2 + 1)) = v1;
                                             | label_1:
    0x004086f8 addiu sp, sp, 0x50            |         
    0x004086fc lw ra, 0x7fdc(sp)             |         ra = *(var_7fdch);
    0x00408700 lw s4, 0x7fd8(sp)             |         s4 = *(var_7fd8h);
    0x00408704 lw s3, 0x7fd4(sp)             |         s3 = *(var_7fd4h);
    0x00408708 lw s2, 0x7fd0(sp)             |         s2 = *(var_7fd0h);
    0x0040870c lw s1, 0x7fcc(sp)             |         s1 = *(var_7fcch);
    0x00408710 lw s0, 0x7fc8(sp)             |         s0 = *(var_7fc8h);
    0x00408714 addiu sp, sp, 0x7fe0          |         
    0x00408718 jr ra                         |         return v0;
                                             | label_2:
    0x0040871c lw t9, -0x7d20(gp)            |         t9 = sym.imp.malloc;
    0x00408720 move a0, s0                   |         a0 = s0;
    0x00408724 jalr t9                       |         t9 ();
    0x00408728 move a1, s0                   |         a1 = s0;
    0x0040872c lw gp, 0x10(sp)               |         gp = *(var_10h);
    0x00408730 move s3, v0                   |         s3 = v0;
    0x00408734 move a0, v0                   |         a0 = v0;
    0x00408738 move a2, s1                   |         a2 = s1;
    0x0040873c lw t9, -0x7d2c(gp)            |         t9 = sym.imp.vsnprintf;
    0x00408740 move a3, s4                   |         a3 = s4;
    0x00408744 jalr t9                       |         t9 ();
    0x00408748 lw gp, 0x10(sp)               |         gp = *(var_10h);
                                             |         if (s3 != 0) {
    0x0040874c beqz s3, 0x4087e4             |             
    0x00408750 nop                           |             
    0x00408754 lw s0, (s2)                   |             s0 = *(s2);
    0x00408758 ori t1, zero, 0x8000          |             t1 = 0x8000;
                                             |             if (s0 == 0) {
    0x0040875c beqz s0, 0x408858             |                 goto label_3;
                                             |             }
                                             | label_0:
    0x00408760 lw t9, -0x7f70(gp)            |             t9 = sym.imp.strlen;
    0x00408764 move a0, s3                   |             a0 = s3;
    0x00408768 jalr t9                       |             t9 ();
    0x0040876c lw t3, 4(s2)                  |             t3 = *((s2 + 1));
    0x00408770 lw a0, 8(s2)                  |             a0 = *((s2 + 2));
    0x00408774 addu v1, t3, v0               |             v1 = t3 + v0;
    0x00408778 sltu t2, v1, a0               |             t2 = (v1 < a0) ? 1 : 0;
    0x0040877c lw gp, 0x10(sp)               |             gp = *(var_10h);
    0x00408780 sll t4, a0, 1                 |             t4 = a0 << 1;
                                             |             if (t2 == 0) {
    0x00408784 bnez t2, 0x4087b4             |                 
    0x00408788 addiu t5, v1, 1               |                 t5 = v1 + 1;
    0x0040878c sltu t6, t4, t5               |                 t6 = (t4 < t5) ? 1 : 0;
    0x00408790 move a0, s0                   |                 a0 = s0;
                                             |                 if (t6 == 0) {
    0x00408794 movn t4, t5, t6               |                     t4 = t5;
                                             |                 }
    0x00408798 lw t9, -0x7e40(gp)            |                 t9 = sym.imp.realloc;
    0x0040879c move a1, t4                   |                 a1 = t4;
    0x004087a0 sw t4, 8(s2)                  |                 *((s2 + 2)) = t4;
    0x004087a4 jalr t9                       |                 t9 ();
    0x004087a8 lw gp, 0x10(sp)               |                 gp = *(var_10h);
    0x004087ac move s0, v0                   |                 s0 = v0;
    0x004087b0 sw v0, (s2)                   |                 *(s2) = v0;
                                             |             }
[31m    0x004087b4 lw t9, -0x7dbc(gp)            |             t9 = sym.imp.strcat;[0m
    0x004087b8 move a0, s0                   |             a0 = s0;
    0x004087bc move a1, s3                   |             a1 = s3;
    0x004087c0 jalr t9                       |             t9 ();
    0x004087c4 lw gp, 0x10(sp)               |             gp = *(var_10h);
    0x004087c8 lw t9, -0x7f70(gp)            |             t9 = sym.imp.strlen;
    0x004087cc move a0, s3                   |             a0 = s3;
    0x004087d0 jalr t9                       |             t9 ();
    0x004087d4 lw s1, 4(s2)                  |             s1 = *((s2 + 1));
    0x004087d8 lw gp, 0x10(sp)               |             gp = *(var_10h);
    0x004087dc addu t7, s1, v0               |             t7 = s1 + v0;
    0x004087e0 sw t7, 4(s2)                  |             *((s2 + 1)) = t7;
                                             |         }
    0x004087e4 lw t9, -0x7fc0(gp)            |         t9 = sym.imp.free;
    0x004087e8 move a0, s3                   |         a0 = s3;
    0x004087ec jalr t9                       |         t9 ();
    0x004087f0 lw gp, 0x10(sp)               |         gp = *(var_10h);
    0x004087f4 addiu sp, sp, 0x50            |         
    0x004087f8 lw ra, 0x7fdc(sp)             |         ra = *(var_7fdch);
    0x004087fc lw s4, 0x7fd8(sp)             |         s4 = *(var_7fd8h);
    0x00408800 lw s3, 0x7fd4(sp)             |         s3 = *(var_7fd4h);
    0x00408804 lw s2, 0x7fd0(sp)             |         s2 = *(var_7fd0h);
    0x00408808 lw s1, 0x7fcc(sp)             |         s1 = *(var_7fcch);
    0x0040880c lw s0, 0x7fc8(sp)             |         s0 = *(var_7fc8h);
    0x00408810 addiu sp, sp, 0x7fe0          |         
    0x00408814 jr ra                         |         return v0;
    0x00408818 lw t9, -0x7d20(gp)            |         t9 = sym.imp.malloc;
    0x0040881c ori s3, zero, 0x8000          |         s3 = 0x8000;
    0x00408820 ori a0, zero, 0x8000          |         a0 = 0x8000;
    0x00408824 sw s3, 8(s2)                  |         *((s2 + 2)) = s3;
    0x00408828 jalr t9                       |         t9 ();
    0x0040882c move a1, zero                 |         a1 = 0;
    0x00408830 lw gp, 0x10(sp)               |         gp = *(var_10h);
    0x00408834 move a0, v0                   |         a0 = v0;
    0x00408838 lw a2, 8(s2)                  |         a2 = *((s2 + 2));
    0x0040883c lw t9, -0x7e80(gp)            |         t9 = sym.imp.memset;
    0x00408840 sw v0, (s2)                   |         *(s2) = v0;
    0x00408844 jalr t9                       |         t9 ();
    0x00408848 lw gp, 0x10(sp)               |         gp = *(var_10h);
    0x0040884c lw s0, (s2)                   |         s0 = *(s2);
    0x00408850 b 0x408674                    |         
                                             |     }
    0x00408854 nop                           |     
                                             | label_3:
    0x00408858 lw t9, -0x7d20(gp)            |     t9 = sym.imp.malloc;
    0x0040885c sw t1, 8(s2)                  |     *((s2 + 2)) = t1;
    0x00408860 ori a0, zero, 0x8000          |     a0 = 0x8000;
    0x00408864 jalr t9                       |     t9 ();
    0x00408868 move a1, zero                 |     a1 = 0;
    0x0040886c lw gp, 0x10(sp)               |     gp = *(var_10h);
    0x00408870 move a0, v0                   |     a0 = v0;
    0x00408874 lw a2, 8(s2)                  |     a2 = *((s2 + 2));
    0x00408878 lw t9, -0x7e80(gp)            |     t9 = sym.imp.memset;
    0x0040887c sw v0, (s2)                   |     *(s2) = v0;
    0x00408880 jalr t9                       |     t9 ();
    0x00408884 lw gp, 0x10(sp)               |     gp = *(var_10h);
    0x00408888 lw s0, (s2)                   |     s0 = *(s2);
    0x0040888c b 0x408760                    |     goto label_0;
    0x00408890 nop                           |     
                                             | }
    ; assembly                                   | /* r2dec pseudo code output */
                                                 | /* /logs/firmware/unblob_extracted/firmware_extract/1180160-3904000.squashfs_v4_le_extract/usr/bin/ushare @ 0x411e80 */
                                                 | #include <stdint.h>
                                                 |  
    ; (fcn) sym.dlna_write_protocol_info ()      | void dlna_write_protocol_info () {
    0x00411e80 lui gp, 5                         |     
    0x00411e84 addiu gp, gp, 0xd40               |     
    0x00411e88 addu gp, gp, t9                   |     gp += t9;
    0x00411e8c addiu sp, sp, -0x418              |     
    0x00411e90 sw ra, 0x414(sp)                  |     *(var_414h) = ra;
    0x00411e94 sw s4, 0x410(sp)                  |     *(var_410h) = s4;
    0x00411e98 sw s3, 0x40c(sp)                  |     *(var_40ch) = s3;
    0x00411e9c sw s2, 0x408(sp)                  |     *(var_408h) = s2;
    0x00411ea0 sw s1, 0x404(sp)                  |     *(var_404h) = s1;
    0x00411ea4 sw s0, 0x400(sp)                  |     *(var_400h) = s0;
    0x00411ea8 sw gp, 0x38(sp)                   |     *(var_38h) = gp;
    0x00411eac lw t0, 0x42c(sp)                  |     t0 = *(arg_42ch);
    0x00411eb0 move s2, a1                       |     s2 = a1;
    0x00411eb4 move s3, a2                       |     s3 = a2;
    0x00411eb8 lw v1, (t0)                       |     v1 = *(t0);
    0x00411ebc sltiu v0, v1, 0x1d                |     v0 = (v1 < 0x1d) ? 1 : 0;
    0x00411ec0 move s4, a3                       |     s4 = a3;
                                                 |     if (v0 != 0) {
    0x00411ec4 bnez v0, 0x411f94                 |         goto label_2;
                                                 |     }
    0x00411ec8 lw v0, -0x7d94(gp)                |     v0 = *(gp);
    0x00411ecc addiu a2, zero, 1                 |     a2 = 1;
    0x00411ed0 lw s0, (v0)                       |     s0 = *(v0);
                                                 |     if (a0 == a2) {
    0x00411ed4 beq a0, a2, 0x411fb0              |         goto label_3;
                                                 |     }
    0x00411ed8 nop                               |     
                                                 |     do {
    0x00411edc lw v1, 4(t0)                      |         v1 = *((t0 + 1));
    0x00411ee0 sltiu t0, v1, 0x22                |         t0 = (v1 < 0x22) ? 1 : 0;
                                                 |         if (t0 != 0) {
    0x00411ee4 bnez t0, 0x411fe0                 |             goto label_4;
                                                 |         }
    0x00411ee8 nop                               |         
                                                 | label_0:
    0x00411eec lw v0, -0x7eb8(gp)                |         v0 = *(gp);
[31m    0x00411ef0 lw t9, -0x7dbc(gp)                |         t9 = sym.imp.strcat;[0m
    0x00411ef4 lw a1, (v0)                       |         a1 = *(v0);
    0x00411ef8 addiu a0, sp, 0x40                |         a0 = sp + 0x40;
    0x00411efc jalr t9                           |         t9 ();
    0x00411f00 move a0, s0                       |         a0 = s0;
    0x00411f04 lw gp, 0x38(sp)                   |         gp = *(var_38h);
    0x00411f08 lw t6, -0x7fe0(gp)                |         t6 = *((gp - 8184));
    0x00411f0c lw t9, -0x7eb4(gp)                |         t9 = sym.imp.strcmp;
                                                 |         /* esilref: 'wav' */
    0x00411f10 addiu a1, t6, -0x6c44             |         a1 = t6 + -0x6c44;
    0x00411f14 jalr t9                           |         t9 ();
    0x00411f18 lw gp, 0x38(sp)                   |         gp = *(var_38h);
                                                 |         if (v0 != 0) {
    0x00411f1c bnez v0, 0x412020                 |             goto label_5;
                                                 |         }
    0x00411f20 nop                               |         
                                                 | label_1:
    0x00411f24 lw t8, -0x7fe0(gp)                |         t8 = *((gp - 8184));
    0x00411f28 addiu s1, sp, 0x240               |         s1 = sp + 0x240;
[31m    0x00411f2c lw t9, -0x7dbc(gp)                |         t9 = sym.imp.strcat;[0m
    0x00411f30 move a1, s1                       |         a1 = s1;
                                                 |         /* esilref: ':DLNA.ORG_OP=01' */
    0x00411f34 addiu s4, t8, -0x6970             |         s4 = t8 + -0x6970;
    0x00411f38 addiu a0, sp, 0x40                |         a0 = sp + 0x40;
    0x00411f3c lw t7, 0xc(s4)                    |         t7 = *((s4 + 3));
    0x00411f40 lw s3, -0x6970(t8)                |         s3 = *((t8 - 6748));
    0x00411f44 lw s2, 4(s4)                      |         s2 = *((s4 + 1));
    0x00411f48 lw s0, 8(s4)                      |         s0 = *((s4 + 2));
    0x00411f4c sw s3, 0x240(sp)                  |         *(var_240h) = s3;
    0x00411f50 sw s2, 0x244(sp)                  |         *(var_244h) = s2;
    0x00411f54 sw s0, 0x248(sp)                  |         *(var_248h) = s0;
    0x00411f58 sw t7, 0x24c(sp)                  |         *(var_24ch) = t7;
    0x00411f5c jalr t9                           |         t9 ();
    0x00411f60 lw gp, 0x38(sp)                   |         gp = *(var_38h);
    0x00411f64 lw t9, -0x7e6c(gp)                |         t9 = sym.imp.strdup;
    0x00411f68 addiu a0, sp, 0x40                |         a0 = sp + 0x40;
    0x00411f6c jalr t9                           |         t9 ();
    0x00411f70 lw gp, 0x38(sp)                   |         gp = *(var_38h);
    0x00411f74 lw ra, 0x414(sp)                  |         ra = *(var_414h);
    0x00411f78 lw s4, 0x410(sp)                  |         s4 = *(var_410h);
    0x00411f7c lw s3, 0x40c(sp)                  |         s3 = *(var_40ch);
    0x00411f80 lw s2, 0x408(sp)                  |         s2 = *(var_408h);
    0x00411f84 lw s1, 0x404(sp)                  |         s1 = *(var_404h);
    0x00411f88 lw s0, 0x400(sp)                  |         s0 = *(var_400h);
    0x00411f8c addiu sp, sp, 0x418               |         
    0x00411f90 jr ra                             |         return v0;
                                                 | label_2:
    0x00411f94 sll a1, v1, 2                     |         a1 = v1 << 2;
    0x00411f98 addiu a2, zero, 1                 |         a2 = 1;
    0x00411f9c lw v1, -0x7d94(gp)                |         v1 = *(gp);
    0x00411fa0 addu v0, a1, v1                   |         v0 = a1 + v1;
    0x00411fa4 lw s0, (v0)                       |         s0 = *(v0);
    0x00411fa8 bne a0, a2, 0x411edc              |         
                                                 |     } while (a0 != a2);
    0x00411fac nop                               |     
                                                 | label_3:
    0x00411fb0 lw t3, -0x7fe0(gp)                |     t3 = *((gp - 8184));
                                                 |     /* esilref: 'http-get:*:' */
    0x00411fb4 addiu t2, t3, -0x6960             |     t2 = t3 + -0x6960;
    0x00411fb8 lw a3, 8(t2)                      |     a3 = *((t2 + 2));
    0x00411fbc lw a0, -0x6960(t3)                |     a0 = *((t3 - 6744));
    0x00411fc0 lw t1, 4(t2)                      |     t1 = *((t2 + 1));
    0x00411fc4 sw a0, 0x40(sp)                   |     *(var_40h) = a0;
    0x00411fc8 sw t1, 0x44(sp)                   |     *(var_44h) = t1;
    0x00411fcc sw a3, 0x48(sp)                   |     *(var_48h) = a3;
    0x00411fd0 lw v1, 4(t0)                      |     v1 = *((t0 + 1));
    0x00411fd4 sltiu t0, v1, 0x22                |     t0 = (v1 < 0x22) ? 1 : 0;
                                                 |     if (t0 == 0) {
    0x00411fd8 beqz t0, 0x411eec                 |         goto label_0;
                                                 |     }
    0x00411fdc nop                               |     
                                                 | label_4:
    0x00411fe0 lw t5, -0x7eb8(gp)                |     t5 = *(gp);
    0x00411fe4 sll t4, v1, 2                     |     t4 = v1 << 2;
[31m    0x00411fe8 lw t9, -0x7dbc(gp)                |     t9 = sym.imp.strcat;[0m
    0x00411fec addu v0, t4, t5                   |     v0 = t4 + t5;
    0x00411ff0 lw a1, (v0)                       |     a1 = *(v0);
    0x00411ff4 addiu a0, sp, 0x40                |     a0 = sp + 0x40;
    0x00411ff8 jalr t9                           |     t9 ();
    0x00411ffc move a0, s0                       |     a0 = s0;
    0x00412000 lw gp, 0x38(sp)                   |     gp = *(var_38h);
    0x00412004 lw t6, -0x7fe0(gp)                |     t6 = *((gp - 8184));
    0x00412008 lw t9, -0x7eb4(gp)                |     t9 = sym.imp.strcmp;
                                                 |     /* esilref: 'wav' */
    0x0041200c addiu a1, t6, -0x6c44             |     a1 = t6 + -0x6c44;
    0x00412010 jalr t9                           |     t9 ();
    0x00412014 lw gp, 0x38(sp)                   |     gp = *(var_38h);
                                                 |     if (v0 == 0) {
    0x00412018 beqz v0, 0x411f24                 |         goto label_1;
                                                 |     }
    0x0041201c nop                               |     
                                                 | label_5:
    0x00412020 lw t4, -0x7fe0(gp)                |     t4 = *((gp - 8184));
    0x00412024 addiu s1, sp, 0x240               |     s1 = sp + 0x240;
    0x00412028 lw t0, -0x7fe0(gp)                |     t0 = *((gp - 8184));
    0x0041202c move a3, s2                       |     a3 = s2;
    0x00412030 lw t2, -0x7fe0(gp)                |     t2 = *((gp - 8184));
                                                 |     /* esilref: 'DLNA.ORG_CI' */
    0x00412034 addiu a0, t4, -0x6954             |     a0 = t4 + -0x6954;
    0x00412038 lw v1, -0x7fe0(gp)                |     v1 = *((gp - 8184));
                                                 |     /* esilref: 'DLNA.ORG_OP' */
    0x0041203c addiu t3, t0, -0x6948             |     t3 = t0 + -0x6948;
    0x00412040 lw ra, 0x428(sp)                  |     ra = *(arg_428h);
                                                 |     /* esilref: 'DLNA.ORG_PN' */
    0x00412044 addiu t1, t2, -0x693c             |     t1 = t2 + -0x693c;
    0x00412048 lw a1, -0x7fe0(gp)                |     a1 = *((gp - 8184));
                                                 |     /* esilref: 'DLNA.ORG_FLAGS' */
    0x0041204c addiu v0, v1, -0x6930             |     v0 = v1 + -0x6930;
    0x00412050 lw a2, -0x7fe0(gp)                |     a2 = *((gp - 8184));
    0x00412054 lw t9, -0x7ed0(gp)                |     t9 = sym.imp.sprintf;
                                                 |     /* esilref: ':&s=&d;&s=&d;&s=&.2x;&s=&s;&s=&.8x&.24x' */
    0x00412058 addiu a1, a1, -0x6920             |     a1 += -0x6920;
    0x0041205c sw ra, 0x2c(sp)                   |     *(var_2ch) = ra;
                                                 |     /* esilref: 'DLNA.ORG_PS' */
    0x00412060 addiu a2, a2, -0x68f8             |     a2 += -0x68f8;
    0x00412064 sw t3, 0x18(sp)                   |     *(var_18h) = t3;
    0x00412068 sw t1, 0x20(sp)                   |     *(var_20h) = t1;
    0x0041206c sw a0, 0x10(sp)                   |     *(var_10h) = a0;
    0x00412070 move a0, s1                       |     a0 = s1;
    0x00412074 sw s3, 0x14(sp)                   |     *(var_14h) = s3;
    0x00412078 sw s4, 0x1c(sp)                   |     *(var_1ch) = s4;
    0x0041207c sw s0, 0x24(sp)                   |     *(var_24h) = s0;
    0x00412080 sw v0, 0x28(sp)                   |     *(var_28h) = v0;
    0x00412084 sw zero, 0x30(sp)                 |     *(var_30h) = 0;
    0x00412088 jalr t9                           |     t9 ();
    0x0041208c move a1, s1                       |     a1 = s1;
    0x00412090 lw gp, 0x38(sp)                   |     gp = *(var_38h);
[31m    0x00412094 lw t9, -0x7dbc(gp)                |     t9 = sym.imp.strcat;[0m
    0x00412098 addiu a0, sp, 0x40                |     a0 = sp + 0x40;
    0x0041209c jalr t9                           |     t9 ();
    0x004120a0 lw gp, 0x38(sp)                   |     gp = *(var_38h);
    0x004120a4 lw t9, -0x7e6c(gp)                |     t9 = sym.imp.strdup;
    0x004120a8 addiu a0, sp, 0x40                |     a0 = sp + 0x40;
    0x004120ac jalr t9                           |     t9 ();
    0x004120b0 lw gp, 0x38(sp)                   |     gp = *(var_38h);
    0x004120b4 lw ra, 0x414(sp)                  |     ra = *(var_414h);
    0x004120b8 lw s4, 0x410(sp)                  |     s4 = *(var_410h);
    0x004120bc lw s3, 0x40c(sp)                  |     s3 = *(var_40ch);
    0x004120c0 lw s2, 0x408(sp)                  |     s2 = *(var_408h);
    0x004120c4 lw s1, 0x404(sp)                  |     s1 = *(var_404h);
    0x004120c8 lw s0, 0x400(sp)                  |     s0 = *(var_400h);
    0x004120cc addiu sp, sp, 0x418               |     
    0x004120d0 jr ra                             |     return v0;
                                                 | }

[*] Function strcat used 9 times ushare

