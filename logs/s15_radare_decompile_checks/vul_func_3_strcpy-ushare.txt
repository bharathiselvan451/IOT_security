[*] Binary protection state of ushare

  
  	No RELRO       No Canary found   NX disabled  No PIE       No RPATH     No RUNPATH   No Symbols


[*] Function strcpy tear down of ushare

    ; assembly                               | /* r2dec pseudo code output */
                                             | /* /logs/firmware/unblob_extracted/firmware_extract/1180160-3904000.squashfs_v4_le_extract/usr/bin/ushare @ 0x406710 */
                                             | #include <stdint.h>
                                             |  
    ; (fcn) fcn.00406710 ()                  | void fcn_00406710 () {
    0x00406710 lui gp, 6                     |     
    0x00406714 addiu gp, gp, -0x3b50         |     
    0x00406718 addu gp, gp, t9               |     gp += t9;
    0x0040671c addiu sp, sp, -0x68           |     
    0x00406720 sw ra, 0x60(sp)               |     *(var_60h) = ra;
    0x00406724 sw s7, 0x5c(sp)               |     *(var_5ch) = s7;
    0x00406728 sw s6, 0x58(sp)               |     *(var_58h) = s6;
    0x0040672c sw s5, 0x54(sp)               |     *(var_54h) = s5;
    0x00406730 sw s4, 0x50(sp)               |     *(var_50h) = s4;
    0x00406734 sw s3, 0x4c(sp)               |     *(var_4ch) = s3;
    0x00406738 sw s2, 0x48(sp)               |     *(var_48h) = s2;
    0x0040673c sw s1, 0x44(sp)               |     *(var_44h) = s1;
    0x00406740 sw s0, 0x40(sp)               |     *(var_40h) = s0;
    0x00406744 sw gp, 0x18(sp)               |     *(var_18h) = gp;
    0x00406748 move v0, zero                 |     v0 = 0;
    0x0040674c move s7, a1                   |     s7 = a1;
    0x00406750 move s4, a0                   |     s4 = a0;
    0x00406754 move s0, a2                   |     s0 = a2;
    0x00406758 sw zero, 0x20(sp)             |     *(var_20h) = 0;
    0x0040675c sw zero, 0x24(sp)             |     *(var_24h) = 0;
    0x00406760 sw zero, 0x28(sp)             |     *(var_28h) = 0;
    0x00406764 sw zero, 0x2c(sp)             |     *(var_2ch) = 0;
    0x00406768 sw zero, 0x30(sp)             |     *(var_30h) = 0;
    0x0040676c sw zero, 0x34(sp)             |     *(var_34h) = 0;
    0x00406770 sw zero, 0x38(sp)             |     *(var_38h) = 0;
    0x00406774 sw zero, 0x3c(sp)             |     *(var_3ch) = 0;
    0x00406778 lw s6, 0x80(sp)               |     s6 = *(arg_80h);
    0x0040677c move s1, a3                   |     s1 = a3;
                                             |     if (a1 == 0) {
    0x00406780 beqz a1, 0x40691c             |         goto label_7;
                                             |     }
    0x00406784 lw t9, -0x7d20(gp)            |     t9 = sym.imp.malloc;
    0x00406788 addiu a0, zero, 0x38          |     a0 = 0x38;
    0x0040678c jalr t9                       |     t9 ();
    0x00406790 move s2, v0                   |     s2 = v0;
    0x00406794 lbu v0, 0x46(s4)              |     v0 = *((s4 + 70));
    0x00406798 lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x0040679c sw zero, 8(s2)                |     *((s2 + 2)) = 0;
    0x004067a0 sw zero, 0x20(s2)             |     *((s2 + 8)) = 0;
                                             |     if (v0 != 0) {
    0x004067a4 bnez v0, 0x406948             |         goto label_19;
                                             |     }
                                             | label_1:
    0x004067a8 lbu a2, 0x50(s4)              |     a2 = *((s4 + 80));
                                             |     if (a2 == 0) {
    0x004067ac beqz a2, 0x406990             |         goto label_20;
                                             |     }
    0x004067b0 nop                           |     
                                             | label_2:
    0x004067b4 lw a3, 0x20(s4)               |     a3 = *((s4 + 8));
                                             |     if (a3 != 0) {
    0x004067b8 bnez a3, 0x406990             |         goto label_20;
                                             |     }
    0x004067bc nop                           |     
    0x004067c0 sw zero, (s2)                 |     *(s2) = 0;
                                             |     if (s6 == 0) {
    0x004067c4 beqz s6, 0x4069ac             |         goto label_21;
                                             |     }
                                             | label_3:
    0x004067c8 move v0, zero                 |     v0 = 0;
                                             |     if (s0 != 0) {
    0x004067cc beqz s0, 0x4067e0             |         
    0x004067d0 lw t9, -0x7e6c(gp)            |         t9 = sym.imp.strdup;
    0x004067d4 move a0, s0                   |         a0 = s0;
    0x004067d8 jalr t9                       |         t9 ();
    0x004067dc lw gp, 0x18(sp)               |         gp = *(var_18h);
                                             |     }
    0x004067e0 addiu s0, zero, -1            |     s0 = -1;
    0x004067e4 move t4, zero                 |     t4 = 0;
    0x004067e8 lw t9, -0x7d20(gp)            |     t9 = sym.imp.malloc;
                                             |     if (s6 != 0) {
    0x004067ec movz t4, s0, s6               |         t4 = s0;
                                             |     }
    0x004067f0 sw v0, 4(s2)                  |     *((s2 + 1)) = v0;
    0x004067f4 addiu a0, zero, 4             |     a0 = 4;
    0x004067f8 sw s1, 0xc(s2)                |     *((s2 + 3)) = s1;
    0x004067fc sw t4, 0x10(s2)               |     *((s2 + 4)) = t4;
    0x00406800 sw zero, 0x1c(s2)             |     *((s2 + 7)) = 0;
    0x00406804 jalr t9                       |     t9 ();
    0x00406808 sw zero, (v0)                 |     *(v0) = 0;
    0x0040680c lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x00406810 sw v0, 0x14(s2)               |     *((s2 + 5)) = v0;
                                             |     if (s6 == 0) {
    0x00406814 beqz s6, 0x4069e4             |         goto label_22;
                                             |     }
                                             | label_4:
    0x00406818 lw a3, -0x7fe8(gp)            |     a3 = *((gp - 8186));
    0x0040681c sw zero, 0x20(s2)             |     *((s2 + 8)) = 0;
    0x00406820 addiu a0, a3, -0x5f30         |     a0 = a3 + -0x5f30;
    0x00406824 sw a0, 0x18(s2)               |     *((s2 + 6)) = a0;
                                             | label_17:
    0x00406828 lw t9, -0x7f30(gp)            |     t9 = sym.iconv_convert;
    0x0040682c move a0, s7                   |     a0 = s7;
    0x00406830 jalr t9                       |     t9 ();
    0x00406834 lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x00406838 move s3, v0                   |     s3 = v0;
                                             |     if (v0 == 0) {
    0x0040683c beqz v0, 0x406bfc             |         goto label_23;
                                             |     }
                                             | label_11:
    0x00406840 move a0, s3                   |     a0 = s3;
                                             |     if (s6 == 0) {
    0x00406844 bnez s6, 0x406864             |         
    0x00406848 lw t9, -0x7d84(gp)            |         t9 = sym.imp.strrchr;
    0x0040684c addiu a1, zero, 0x2e          |         a1 = 0x2e;
    0x00406850 jalr t9                       |         t9 ();
    0x00406854 lw gp, 0x18(sp)               |         gp = *(var_18h);
                                             |         if (v0 == 0) {
    0x00406858 beqz v0, 0x406864             |             goto label_24;
                                             |         }
    0x0040685c nop                           |         
    0x00406860 sb zero, (v0)                 |         *(v0) = 0;
                                             |     }
                                             | label_24:
    0x00406864 lbu v0, (s3)                  |     v0 = *(s3);
    0x00406868 move s5, zero                 |     s5 = 0;
    0x0040686c move s0, s3                   |     s0 = s3;
                                             |     if (v0 == 0) {
    0x00406870 beqz v0, 0x4068dc             |         goto label_13;
                                             |     }
    0x00406874 lw t2, -0x7fe8(gp)            |     t2 = *((gp - 8186));
    0x00406878 move v1, v0                   |     v1 = v0;
    0x0040687c addiu t1, t2, -0x5f10         |     t1 = t2 + -0x5f10;
    0x00406880 lw s1, 4(t1)                  |     s1 = *((t1 + 1));
    0x00406884 move s4, t1                   |     s4 = t1;
                                             | label_0:
    0x00406888 sll t3, v1, 0x18              |     t3 = v1 << 0x18;
    0x0040688c move a2, zero                 |     a2 = 0;
    0x00406890 sra t0, t3, 0x18              |     t0 = t3 >> 0x18;
                                             |     if (s1 == 0) {
    0x00406894 beqz s1, 0x4068c4             |         goto label_8;
                                             |     }
    0x00406898 move a1, zero                 |     a1 = 0;
    0x0040689c move a3, s4                   |     a3 = s4;
                                             |     do {
    0x004068a0 addu a0, a1, a3               |         a0 = a1 + a3;
    0x004068a4 addiu a2, a2, 1               |         a2++;
    0x004068a8 lb t4, (a0)                   |         t4 = *(a0);
    0x004068ac sll a1, a2, 3                 |         a1 = a2 << 3;
    0x004068b0 addu v1, a1, a3               |         v1 = a1 + a3;
                                             |         if (t4 == t0) {
    0x004068b4 beq t4, t0, 0x406b9c          |             goto label_25;
                                             |         }
    0x004068b8 lw t5, 4(v1)                  |         t5 = *((v1 + 1));
    0x004068bc bnez t5, 0x4068a0             |         
                                             |     } while (t5 != 0);
    0x004068c0 nop                           |     
                                             | label_8:
    0x004068c4 addiu s0, s0, 1               |     s0++;
    0x004068c8 lbu v1, (s0)                  |     v1 = *(s0);
                                             |     if (v1 != 0) {
    0x004068cc bnez v1, 0x406888             |         goto label_0;
                                             |     }
    0x004068d0 nop                           |     
                                             |     if (s5 != 0) {
                                             | label_9:
    0x004068d4 bnez s5, 0x406c44             |         goto label_26;
                                             |     }
    0x004068d8 nop                           |     
                                             | label_13:
    0x004068dc sw s3, 0x1c(s2)               |     *((s2 + 7)) = s3;
                                             | label_14:
    0x004068e0 lbu s5, (s3)                  |     s5 = *(s3);
                                             |     if (s5 == 0) {
    0x004068e4 beqz s5, 0x406bd0             |         goto label_27;
                                             |     }
    0x004068e8 nop                           |     
                                             | label_10:
    0x004068ec lw a1, 0x7c(sp)               |     a1 = *(arg_7ch);
    0x004068f0 addiu s3, zero, -1            |     s3 = -1;
    0x004068f4 lw s6, 0x78(sp)               |     s6 = *(arg_78h);
    0x004068f8 lw a2, (s2)                   |     a2 = *(s2);
    0x004068fc sw a1, 0x2c(s2)               |     *((s2 + 11)) = a1;
    0x00406900 sw s6, 0x28(s2)               |     *((s2 + 10)) = s6;
    0x00406904 sw s3, 0x30(s2)               |     *((s2 + 12)) = s3;
                                             |     if (a2 != 0) {
    0x00406908 beqz a2, 0x406918             |         
    0x0040690c lw a3, 0x20(s2)               |         a3 = *((s2 + 8));
                                             |         if (a3 != 0) {
    0x00406910 bnez a3, 0x406b7c             |             goto label_28;
                                             |         }
    0x00406914 nop                           |         
                                             |     }
    0x00406918 move v0, s2                   |     v0 = s2;
                                             | label_7:
    0x0040691c lw ra, 0x60(sp)               |     ra = *(var_60h);
    0x00406920 lw s7, 0x5c(sp)               |     s7 = *(var_5ch);
    0x00406924 lw s6, 0x58(sp)               |     s6 = *(var_58h);
    0x00406928 lw s5, 0x54(sp)               |     s5 = *(var_54h);
    0x0040692c lw s4, 0x50(sp)               |     s4 = *(var_50h);
    0x00406930 lw s3, 0x4c(sp)               |     s3 = *(var_4ch);
    0x00406934 lw s2, 0x48(sp)               |     s2 = *(var_48h);
    0x00406938 lw s1, 0x44(sp)               |     s1 = *(var_44h);
    0x0040693c lw s0, 0x40(sp)               |     s0 = *(var_40h);
    0x00406940 addiu sp, sp, 0x68            |     
    0x00406944 jr ra                         |     return v0;
                                             |     if (s0 == 0) {
                                             | label_19:
    0x00406948 beqz s0, 0x4067a8             |         goto label_1;
                                             |     }
    0x0040694c nop                           |     
                                             |     if (s6 != 0) {
    0x00406950 bnez s6, 0x4067a8             |         goto label_1;
                                             |     }
    0x00406954 nop                           |     
    0x00406958 lw t9, -0x7f0c(gp)            |     t9 = sym.dlna_guess_media_profile2;
    0x0040695c lw a0, 0x48(s4)               |     a0 = *((s4 + 18));
    0x00406960 move a1, s0                   |     a1 = s0;
    0x00406964 jalr t9                       |     t9 ();
    0x00406968 lw gp, 0x18(sp)               |     gp = *(var_18h);
                                             |     if (v0 == 0) {
    0x0040696c beqz v0, 0x406e0c             |         goto label_29;
                                             |     }
    0x00406970 nop                           |     
    0x00406974 lw v1, -0x7fe8(gp)            |     v1 = *((gp - 8186));
    0x00406978 lbu a2, 0x50(s4)              |     a2 = *((s4 + 80));
    0x0040697c lw a1, -0x5f24(v1)            |     a1 = *((v1 - 6089));
    0x00406980 sw v0, 8(s2)                  |     *((s2 + 2)) = v0;
    0x00406984 addiu a0, a1, 1               |     a0 = a1 + 1;
    0x00406988 sw a0, -0x5f24(v1)            |     *((v1 - 6089)) = a0;
                                             |     if (a2 != 0) {
    0x0040698c bnez a2, 0x4067b4             |         goto label_2;
                                             |     }
                                             | label_20:
    0x00406990 lw t3, 0x24(s4)               |     t3 = *((s4 + 9));
    0x00406994 lw t2, 0x28(s4)               |     t2 = *((s4 + 10));
    0x00406998 addiu t1, t3, 1               |     t1 = t3 + 1;
    0x0040699c addu t0, t2, t3               |     t0 = t2 + t3;
    0x004069a0 sw t1, 0x24(s4)               |     *((s4 + 9)) = t1;
    0x004069a4 sw t0, (s2)                   |     *(s2) = t0;
                                             |     if (s6 != 0) {
    0x004069a8 bnez s6, 0x4067c8             |         goto label_3;
                                             |     }
                                             | label_21:
    0x004069ac addiu s0, zero, -1            |     s0 = -1;
    0x004069b0 move t4, zero                 |     t4 = 0;
    0x004069b4 lw t9, -0x7d20(gp)            |     t9 = sym.imp.malloc;
                                             |     if (s6 != 0) {
    0x004069b8 movz t4, s0, s6               |         t4 = s0;
                                             |     }
    0x004069bc sw zero, 4(s2)                |     *((s2 + 1)) = 0;
    0x004069c0 addiu a0, zero, 4             |     a0 = 4;
    0x004069c4 sw s1, 0xc(s2)                |     *((s2 + 3)) = s1;
    0x004069c8 sw t4, 0x10(s2)               |     *((s2 + 4)) = t4;
    0x004069cc sw zero, 0x1c(s2)             |     *((s2 + 7)) = 0;
    0x004069d0 jalr t9                       |     t9 ();
    0x004069d4 sw zero, (v0)                 |     *(v0) = 0;
    0x004069d8 lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x004069dc sw v0, 0x14(s2)               |     *((s2 + 5)) = v0;
                                             |     if (s6 != 0) {
    0x004069e0 bnez s6, 0x406818             |         goto label_4;
                                             |     }
                                             | label_22:
    0x004069e4 lbu t5, 0x46(s4)              |     t5 = *((s4 + 70));
    0x004069e8 move a0, s7                   |     a0 = s7;
                                             |     if (t5 == 0) {
    0x004069ec beqz t5, 0x406ae8             |         goto label_30;
                                             |     }
    0x004069f0 lw t9, -0x7d84(gp)            |     t9 = sym.imp.strrchr;
    0x004069f4 addiu a1, zero, 0x2e          |     a1 = 0x2e;
    0x004069f8 move s3, zero                 |     s3 = 0;
    0x004069fc jalr t9                       |     t9 ();
    0x00406a00 addiu t6, v0, 1               |     t6 = v0 + 1;
                                             |     if (v0 == 0) {
    0x00406a04 movn s3, t6, v0               |         s3 = t6;
                                             |     }
    0x00406a08 lw gp, 0x18(sp)               |     gp = *(var_18h);
                                             |     if (s3 == 0) {
    0x00406a0c beqz s3, 0x406a7c             |         goto label_5;
                                             |     }
    0x00406a10 nop                           |     
    0x00406a14 lw s1, -0x7d58(gp)            |     s1 = *(gp);
    0x00406a18 lw t7, (s1)                   |     t7 = *(s1);
    0x00406a1c addiu s5, zero, -1            |     s5 = -1;
                                             |     if (t7 == s0) {
    0x00406a20 beq t7, s0, 0x406a7c          |         goto label_5;
                                             |     }
                                             |     do {
    0x00406a24 lw t9, -0x7dd8(gp)            |         t9 = sym.mime_get_extension;
    0x00406a28 move a0, s1                   |         a0 = s1;
    0x00406a2c jalr t9                       |         t9 ();
    0x00406a30 move a0, s1                   |         a0 = s1;
    0x00406a34 lw gp, 0x18(sp)               |         gp = *(var_18h);
    0x00406a38 lw t9, -0x7dd8(gp)            |         t9 = sym.mime_get_extension;
    0x00406a3c move s0, v0                   |         s0 = v0;
    0x00406a40 jalr t9                       |         t9 ();
    0x00406a44 move a0, s0                   |         a0 = s0;
    0x00406a48 lw gp, 0x18(sp)               |         gp = *(var_18h);
    0x00406a4c lw t9, -0x7e38(gp)            |         t9 = sym.imp.strcasecmp;
    0x00406a50 move a1, s3                   |         a1 = s3;
                                             |         if (v0 == 0) {
    0x00406a54 beqz v0, 0x406a7c             |             goto label_5;
                                             |         }
    0x00406a58 jalr t9                       |         t9 ();
    0x00406a5c nop                           |         
    0x00406a60 lw gp, 0x18(sp)               |         gp = *(var_18h);
                                             |         if (v0 == 0) {
    0x00406a64 beqz v0, 0x406d48             |             goto label_31;
                                             |         }
    0x00406a68 nop                           |         
    0x00406a6c addiu s1, s1, 0xc             |         s1 += 0xc;
    0x00406a70 lw t8, (s1)                   |         t8 = *(s1);
    0x00406a74 bne t8, s5, 0x406a24          |         
                                             |     } while (t8 != s5);
    0x00406a78 nop                           |     
                                             |     do {
                                             | label_5:
    0x00406a7c lw s6, 0x24(s4)               |         s6 = *((s4 + 9));
    0x00406a80 move a1, s2                   |         a1 = s2;
    0x00406a84 lw t9, -0x7ea8(gp)            |         t9 = sym.upnp_entry_free;
    0x00406a88 move a0, s4                   |         a0 = s4;
    0x00406a8c addiu s3, s6, -1              |         s3 = s6 + -1;
    0x00406a90 sw s3, 0x24(s4)               |         *((s4 + 9)) = s3;
    0x00406a94 jalr t9                       |         t9 ();
    0x00406a98 move a2, s7                   |         a2 = s7;
    0x00406a9c lw gp, 0x18(sp)               |         gp = *(var_18h);
    0x00406aa0 addiu a0, zero, 2             |         a0 = 2;
    0x00406aa4 lw s2, -0x7fd8(gp)            |         s2 = *((gp - 8182));
    0x00406aa8 lw t9, -0x7d5c(gp)            |         t9 = sym.print_log;
    0x00406aac addiu a1, s2, 0x6bb4          |         a1 = s2 + 0x6bb4;
    0x00406ab0 jalr t9                       |         t9 ();
    0x00406ab4 move v0, zero                 |         v0 = 0;
    0x00406ab8 lw gp, 0x18(sp)               |         gp = *(var_18h);
                                             | label_18:
    0x00406abc lw ra, 0x60(sp)               |         ra = *(var_60h);
    0x00406ac0 lw s7, 0x5c(sp)               |         s7 = *(var_5ch);
    0x00406ac4 lw s6, 0x58(sp)               |         s6 = *(var_58h);
    0x00406ac8 lw s5, 0x54(sp)               |         s5 = *(var_54h);
    0x00406acc lw s4, 0x50(sp)               |         s4 = *(var_50h);
    0x00406ad0 lw s3, 0x4c(sp)               |         s3 = *(var_4ch);
    0x00406ad4 lw s2, 0x48(sp)               |         s2 = *(var_48h);
    0x00406ad8 lw s1, 0x44(sp)               |         s1 = *(var_44h);
    0x00406adc lw s0, 0x40(sp)               |         s0 = *(var_40h);
    0x00406ae0 addiu sp, sp, 0x68            |         
    0x00406ae4 jr ra                         |         return v0;
                                             | label_30:
    0x00406ae8 lw t9, -0x7d84(gp)            |         t9 = sym.imp.strrchr;
    0x00406aec addiu a1, zero, 0x2e          |         a1 = 0x2e;
    0x00406af0 move s3, zero                 |         s3 = 0;
    0x00406af4 jalr t9                       |         t9 ();
    0x00406af8 addiu s1, v0, 1               |         s1 = v0 + 1;
                                             |         if (v0 == 0) {
    0x00406afc movn s3, s1, v0               |             s3 = s1;
                                             |         }
    0x00406b00 lw gp, 0x18(sp)               |         gp = *(var_18h);
    0x00406b04 beqz s3, 0x406a7c             |         
                                             |     } while (s3 == 0);
    0x00406b08 nop                           |     
    0x00406b0c lw s1, -0x7d58(gp)            |     s1 = *(gp);
    0x00406b10 lw s5, (s1)                   |     s5 = *(s1);
    0x00406b14 addiu s5, zero, -1            |     s5 = -1;
                                             |     if (s5 == s0) {
    0x00406b18 beq s5, s0, 0x406a7c          |         goto label_5;
                                             |     }
                                             | label_6:
    0x00406b1c lw t9, -0x7dd8(gp)            |     t9 = sym.mime_get_extension;
    0x00406b20 move a0, s1                   |     a0 = s1;
    0x00406b24 jalr t9                       |     t9 ();
    0x00406b28 move a0, s1                   |     a0 = s1;
    0x00406b2c lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x00406b30 lw t9, -0x7dd8(gp)            |     t9 = sym.mime_get_extension;
    0x00406b34 move s0, v0                   |     s0 = v0;
    0x00406b38 jalr t9                       |     t9 ();
    0x00406b3c move a0, s0                   |     a0 = s0;
    0x00406b40 lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x00406b44 lw t9, -0x7e38(gp)            |     t9 = sym.imp.strcasecmp;
    0x00406b48 move a1, s3                   |     a1 = s3;
                                             |     if (v0 == 0) {
    0x00406b4c beqz v0, 0x406a7c             |         goto label_5;
                                             |     }
    0x00406b50 jalr t9                       |     t9 ();
    0x00406b54 nop                           |     
    0x00406b58 lw gp, 0x18(sp)               |     gp = *(var_18h);
                                             |     if (v0 == 0) {
    0x00406b5c beqz v0, 0x406d48             |         goto label_31;
                                             |     }
    0x00406b60 nop                           |     
    0x00406b64 addiu s1, s1, 0xc             |     s1 += 0xc;
    0x00406b68 lw ra, (s1)                   |     ra = *(s1);
                                             |     if (ra != s5) {
    0x00406b6c bne ra, s5, 0x406b1c          |         goto label_6;
                                             |     }
    0x00406b70 nop                           |     
    0x00406b74 b 0x406a7c                    |     goto label_5;
    0x00406b78 nop                           |     
                                             | label_28:
    0x00406b7c lw t0, -0x7fd8(gp)            |     t0 = *((gp - 8182));
    0x00406b80 addiu a0, zero, 3             |     a0 = 3;
    0x00406b84 lw t9, -0x7d5c(gp)            |     t9 = sym.print_log;
    0x00406b88 addiu a1, t0, 0x6bdc          |     a1 = t0 + 0x6bdc;
    0x00406b8c jalr t9                       |     t9 ();
    0x00406b90 lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x00406b94 move v0, s2                   |     v0 = s2;
    0x00406b98 b 0x40691c                    |     goto label_7;
                                             | label_25:
    0x00406b9c lw a0, 4(a0)                  |     a0 = *((a0 + 1));
                                             |     if (a0 == 0) {
    0x00406ba0 beqz a0, 0x4068c4             |         goto label_8;
                                             |     }
    0x00406ba4 nop                           |     
    0x00406ba8 lw t9, -0x7f70(gp)            |     t9 = sym.imp.strlen;
    0x00406bac addiu s0, s0, 1               |     s0++;
    0x00406bb0 jalr t9                       |     t9 ();
    0x00406bb4 lbu v1, (s0)                  |     v1 = *(s0);
    0x00406bb8 addu t6, v0, s5               |     t6 = v0 + s5;
    0x00406bbc lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x00406bc0 addiu s5, t6, -1              |     s5 = t6 + -1;
                                             |     if (v1 != 0) {
    0x00406bc4 bnez v1, 0x406888             |         goto label_0;
                                             |     }
    0x00406bc8 b 0x4068d4                    |     goto label_9;
    0x00406bcc nop                           |     
                                             | label_27:
    0x00406bd0 lw t9, -0x7fc0(gp)            |     t9 = sym.imp.free;
    0x00406bd4 move a0, s3                   |     a0 = s3;
    0x00406bd8 jalr t9                       |     t9 ();
    0x00406bdc lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x00406be0 lw s0, -0x7fd8(gp)            |     s0 = *((gp - 8182));
    0x00406be4 lw t9, -0x7e6c(gp)            |     t9 = sym.imp.strdup;
    0x00406be8 addiu a0, s0, 0x6bf4          |     a0 = s0 + 0x6bf4;
    0x00406bec jalr t9                       |     t9 ();
    0x00406bf0 lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x00406bf4 sw v0, 0x1c(s2)               |     *((s2 + 7)) = v0;
    0x00406bf8 b 0x4068ec                    |     goto label_10;
                                             | label_23:
    0x00406bfc lbu t0, 0x53(s4)              |     t0 = *((s4 + 83));
    0x00406c00 move a0, s4                   |     a0 = s4;
                                             |     if (t0 == 0) {
    0x00406c04 beqz t0, 0x406dd4             |         goto label_32;
                                             |     }
    0x00406c08 lw t9, -0x7e6c(gp)            |     t9 = sym.imp.strdup;
    0x00406c0c move a0, s7                   |     a0 = s7;
    0x00406c10 jalr t9                       |     t9 ();
    0x00406c14 move a3, s7                   |     a3 = s7;
    0x00406c18 lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x00406c1c addiu a0, zero, 2             |     a0 = 2;
    0x00406c20 lw a2, (s2)                   |     a2 = *(s2);
    0x00406c24 move s3, v0                   |     s3 = v0;
    0x00406c28 lw s4, -0x7fd8(gp)            |     s4 = *((gp - 8182));
    0x00406c2c lw t9, -0x7d5c(gp)            |     t9 = sym.print_log;
    0x00406c30 addiu a1, s4, 0x6bfc          |     a1 = s4 + 0x6bfc;
    0x00406c34 jalr t9                       |     t9 ();
    0x00406c38 lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x00406c3c b 0x406840                    |     goto label_11;
    0x00406c40 nop                           |     
                                             | label_26:
    0x00406c44 lw t9, -0x7f70(gp)            |     t9 = sym.imp.strlen;
    0x00406c48 move a0, s3                   |     a0 = s3;
    0x00406c4c move s4, s3                   |     s4 = s3;
    0x00406c50 jalr t9                       |     t9 ();
    0x00406c54 lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x00406c58 addu t8, v0, s5               |     t8 = v0 + s5;
    0x00406c5c lw t9, -0x7d20(gp)            |     t9 = sym.imp.malloc;
    0x00406c60 addiu a0, t8, 1               |     a0 = t8 + 1;
    0x00406c64 jalr t9                       |     t9 ();
    0x00406c68 lbu t1, (s3)                  |     t1 = *(s3);
    0x00406c6c move s5, v0                   |     s5 = v0;
    0x00406c70 move s0, v0                   |     s0 = v0;
    0x00406c74 sll t7, t1, 0x18              |     t7 = t1 << 0x18;
    0x00406c78 sra v0, t7, 0x18              |     v0 = t7 >> 0x18;
    0x00406c7c lw gp, 0x18(sp)               |     gp = *(var_18h);
                                             |     if (v0 == 0) {
    0x00406c80 beqz v0, 0x406cf0             |         goto label_33;
                                             |     }
    0x00406c84 nop                           |     
    0x00406c88 lw s1, -0x7fe8(gp)            |     s1 = *((gp - 8186));
    0x00406c8c move a3, v0                   |     a3 = v0;
    0x00406c90 addiu s6, s1, -0x5f10         |     s6 = s1 + -0x5f10;
                                             | label_12:
    0x00406c94 lw v0, -0x7fe8(gp)            |     v0 = *((gp - 8186));
    0x00406c98 lw ra, -0x5f0c(v0)            |     ra = *((v0 - 6083));
    0x00406c9c move a2, zero                 |     a2 = 0;
                                             |     if (ra == 0) {
    0x00406ca0 beqz ra, 0x406cd0             |         goto label_15;
                                             |     }
    0x00406ca4 move a1, zero                 |     a1 = 0;
    0x00406ca8 move t0, s6                   |     t0 = s6;
    0x00406cac addu a0, a1, t0               |     a0 = a1 + t0;
                                             |     do {
    0x00406cb0 addiu a2, a2, 1               |         a2++;
    0x00406cb4 lb s7, (a0)                   |         s7 = *(a0);
    0x00406cb8 sll a1, a2, 3                 |         a1 = a2 << 3;
    0x00406cbc addu v1, a1, t0               |         v1 = a1 + t0;
                                             |         if (s7 == a3) {
    0x00406cc0 beq s7, a3, 0x406d14          |             goto label_34;
                                             |         }
    0x00406cc4 lw a0, 4(v1)                  |         a0 = *((v1 + 1));
    0x00406cc8 addu a0, a1, t0               |         a0 = a1 + t0;
    0x00406ccc bnez a0, 0x406cb0             |         
                                             |     } while (a0 != 0);
                                             | label_15:
    0x00406cd0 sb t1, (s0)                   |     *(s0) = t1;
    0x00406cd4 addiu s0, s0, 1               |     s0++;
                                             | label_16:
    0x00406cd8 addiu s4, s4, 1               |     s4++;
    0x00406cdc lbu t1, (s4)                  |     t1 = *(s4);
    0x00406ce0 sll v1, t1, 0x18              |     v1 = t1 << 0x18;
    0x00406ce4 sra a3, v1, 0x18              |     a3 = v1 >> 0x18;
                                             |     if (a3 != 0) {
    0x00406ce8 bnez a3, 0x406c94             |         goto label_12;
                                             |     }
    0x00406cec nop                           |     
                                             | label_33:
    0x00406cf0 sb zero, (s0)                 |     *(s0) = 0;
                                             |     if (s5 == 0) {
    0x00406cf4 beqz s5, 0x4068dc             |         goto label_13;
                                             |     }
    0x00406cf8 lw t9, -0x7fc0(gp)            |     t9 = sym.imp.free;
    0x00406cfc move a0, s3                   |     a0 = s3;
    0x00406d00 move s3, s5                   |     s3 = s5;
    0x00406d04 jalr t9                       |     t9 ();
    0x00406d08 lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x00406d0c sw s3, 0x1c(s2)               |     *((s2 + 7)) = s3;
    0x00406d10 b 0x4068e0                    |     goto label_14;
                                             | label_34:
    0x00406d14 lw s1, 4(a0)                  |     s1 = *((a0 + 1));
    0x00406d18 move a0, s0                   |     a0 = s0;
                                             |     if (s1 == 0) {
    0x00406d1c beqz s1, 0x406cd0             |         goto label_15;
                                             |     }
[31m    0x00406d20 lw t9, -0x7c74(gp)            |     t9 = sym.imp.strcpy;[0m
    0x00406d24 move a1, s1                   |     a1 = s1;
    0x00406d28 jalr t9                       |     t9 ();
    0x00406d2c lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x00406d30 lw t9, -0x7f70(gp)            |     t9 = sym.imp.strlen;
    0x00406d34 move a0, s1                   |     a0 = s1;
    0x00406d38 jalr t9                       |     t9 ();
    0x00406d3c lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x00406d40 addu s0, s0, v0               |     s0 += v0;
    0x00406d44 b 0x406cd8                    |     goto label_16;
                                             | label_31:
    0x00406d48 move a0, s7                   |     a0 = s7;
                                             |     if (s1 == 0) {
    0x00406d4c beqz s1, 0x406a7c             |         goto label_5;
                                             |     }
    0x00406d50 lw t9, -0x7d84(gp)            |     t9 = sym.imp.strrchr;
    0x00406d54 addiu a1, zero, 0x2e          |     a1 = 0x2e;
    0x00406d58 sw s1, 0x18(s2)               |     *((s2 + 6)) = s1;
    0x00406d5c jalr t9                       |     t9 ();
    0x00406d60 addiu a0, sp, 0x20            |     a0 = sp + 0x20;
    0x00406d64 lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x00406d68 addiu a2, v0, 1               |     a2 = v0 + 1;
                                             |     if (v0 != 0) {
    0x00406d6c movz a2, zero, v0             |         a2 = 0;
                                             |     }
    0x00406d70 addiu a1, zero, 0x20          |     a1 = 0x20;
    0x00406d74 lw v1, -0x7fd8(gp)            |     v1 = *((gp - 8182));
    0x00406d78 lw a3, (s2)                   |     a3 = *(s2);
    0x00406d7c lw t9, -0x7ccc(gp)            |     t9 = sym.imp.snprintf;
    0x00406d80 sw a2, 0x10(sp)               |     *(var_10h) = a2;
    0x00406d84 addiu a2, v1, 0x6c1c          |     a2 = v1 + 0x6c1c;
    0x00406d88 jalr t9                       |     t9 ();
    0x00406d8c slti v0, v0, 0x20             |     v0 = (v0 < 0x20) ? 1 : 0;
    0x00406d90 lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x00406d94 addiu a0, zero, 2             |     a0 = 2;
    0x00406d98 beqz v0, 0x406db4             |     
                                             |     while (1) {
    0x00406d9c lw t9, -0x7e6c(gp)            |         t9 = sym.imp.strdup;
    0x00406da0 addiu a0, sp, 0x20            |         a0 = sp + 0x20;
    0x00406da4 jalr t9                       |         t9 ();
    0x00406da8 lw gp, 0x18(sp)               |         gp = *(var_18h);
    0x00406dac sw v0, 0x20(s2)               |         *((s2 + 8)) = v0;
    0x00406db0 b 0x406828                    |         goto label_17;
    0x00406db4 lw a1, -0x7fd8(gp)            |         a1 = *((gp - 8182));
    0x00406db8 lw t9, -0x7d5c(gp)            |         t9 = sym.print_log;
    0x00406dbc lw a2, (s2)                   |         a2 = *(s2);
    0x00406dc0 addiu a1, a1, 0x6c24          |         a1 += 0x6c24;
    0x00406dc4 jalr t9                       |         t9 ();
    0x00406dc8 lw gp, 0x18(sp)               |         gp = *(var_18h);
    0x00406dcc b 0x406d9c                    |         
                                             |     }
    0x00406dd0 nop                           |     
                                             | label_32:
    0x00406dd4 lw t9, -0x7ea8(gp)            |     t9 = sym.upnp_entry_free;
    0x00406dd8 move a1, s2                   |     a1 = s2;
    0x00406ddc jalr t9                       |     t9 ();
    0x00406de0 move a3, s7                   |     a3 = s7;
    0x00406de4 lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x00406de8 addiu a0, zero, 2             |     a0 = 2;
    0x00406dec lw a2, (s2)                   |     a2 = *(s2);
    0x00406df0 lw s7, -0x7fd8(gp)            |     s7 = *((gp - 8182));
    0x00406df4 lw t9, -0x7d5c(gp)            |     t9 = sym.print_log;
    0x00406df8 addiu a1, s7, 0x6c50          |     a1 = s7 + 0x6c50;
    0x00406dfc jalr t9                       |     t9 ();
    0x00406e00 lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x00406e04 move v0, zero                 |     v0 = 0;
    0x00406e08 b 0x406abc                    |     goto label_18;
                                             | label_29:
    0x00406e0c lw t9, -0x7fc0(gp)            |     t9 = sym.imp.free;
    0x00406e10 move a0, s2                   |     a0 = s2;
    0x00406e14 jalr t9                       |     t9 ();
    0x00406e18 lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x00406e1c move v0, zero                 |     v0 = 0;
    0x00406e20 b 0x406abc                    |     goto label_18;
                                             | }
    ; assembly                               | /* r2dec pseudo code output */
                                             | /* /logs/firmware/unblob_extracted/firmware_extract/1180160-3904000.squashfs_v4_le_extract/usr/bin/ushare @ 0x40e13c */
                                             | #include <stdint.h>
                                             |  
    ; (fcn) fcn.0040e13c ()                  | void fcn_0040e13c () {
    0x0040e13c lui gp, 5                     |     
    0x0040e140 addiu gp, gp, 0x4a84          |     
    0x0040e144 addu gp, gp, t9               |     gp += t9;
    0x0040e148 addiu sp, sp, -0x60           |     
    0x0040e14c sw ra, 0x58(sp)               |     *(var_58h) = ra;
    0x0040e150 sw s1, 0x54(sp)               |     *(var_54h) = s1;
    0x0040e154 sw s0, 0x50(sp)               |     *(var_50h) = s0;
    0x0040e158 sw gp, 0x28(sp)               |     *(var_28h) = gp;
    0x0040e15c move a2, zero                 |     a2 = 0;
    0x0040e160 move s0, a0                   |     s0 = a0;
    0x0040e164 addiu a1, zero, 2             |     a1 = 2;
    0x0040e168 lw t9, -0x7d3c(gp)            |     t9 = sym.imp.socket;
    0x0040e16c addiu a0, zero, 2             |     a0 = 2;
    0x0040e170 move v0, zero                 |     v0 = 0;
                                             |     if (s0 == 0) {
    0x0040e174 beqz s0, 0x40e270             |         goto label_0;
                                             |     }
    0x0040e178 jalr t9                       |     t9 ();
    0x0040e17c nop                           |     
    0x0040e180 move a1, s0                   |     a1 = s0;
    0x0040e184 lw gp, 0x28(sp)               |     gp = *(var_28h);
    0x0040e188 move s1, v0                   |     s1 = v0;
[31m    0x0040e18c lw t9, -0x7c74(gp)            |     t9 = sym.imp.strcpy;[0m
    0x0040e190 move v1, t9                   |     v1 = t9;
    0x0040e194 lw t9, -0x7d00(gp)            |     t9 = sym.imp.perror;
    0x0040e198 addiu a0, sp, 0x30            |     a0 = sp + 0x30;
                                             |     if (v0 < 0) {
    0x0040e19c bltz v0, 0x40e298             |         goto label_1;
                                             |     }
    0x0040e1a0 move t9, v1                   |     t9 = v1;
    0x0040e1a4 jalr t9                       |     t9 ();
    0x0040e1a8 nop                           |     
    0x0040e1ac ori a1, zero, 0x8927          |     a1 = 0x8927;
    0x0040e1b0 lw gp, 0x28(sp)               |     gp = *(var_28h);
    0x0040e1b4 move a0, s1                   |     a0 = s1;
    0x0040e1b8 addiu a2, sp, 0x30            |     a2 = sp + 0x30;
    0x0040e1bc lw t9, -0x7c7c(gp)            |     t9 = sym.imp.ioctl;
    0x0040e1c0 sb zero, 0x42(sp)             |     *(var_42h) = 0;
    0x0040e1c4 jalr t9                       |     t9 ();
    0x0040e1c8 lw gp, 0x28(sp)               |     gp = *(var_28h);
    0x0040e1cc lw t9, -0x7d20(gp)            |     t9 = sym.imp.malloc;
    0x0040e1d0 move a1, t9                   |     a1 = t9;
    0x0040e1d4 lw t9, -0x7d00(gp)            |     t9 = sym.imp.perror;
    0x0040e1d8 addiu a0, zero, 0x40          |     a0 = 0x40;
                                             |     if (v0 < 0) {
    0x0040e1dc bltz v0, 0x40e2b0             |         goto label_2;
                                             |     }
    0x0040e1e0 move t9, a1                   |     t9 = a1;
    0x0040e1e4 jalr t9                       |     t9 ();
    0x0040e1e8 nop                           |     
    0x0040e1ec move a1, zero                 |     a1 = 0;
    0x0040e1f0 lw gp, 0x28(sp)               |     gp = *(var_28h);
    0x0040e1f4 move a0, v0                   |     a0 = v0;
    0x0040e1f8 addiu a2, zero, 0x40          |     a2 = 0x40;
    0x0040e1fc lw t9, -0x7e80(gp)            |     t9 = sym.imp.memset;
    0x0040e200 move s0, v0                   |     s0 = v0;
    0x0040e204 jalr t9                       |     t9 ();
    0x0040e208 move a0, s0                   |     a0 = s0;
    0x0040e20c lw gp, 0x28(sp)               |     gp = *(var_28h);
    0x0040e210 addiu a1, zero, 0x40          |     a1 = 0x40;
    0x0040e214 lbu t4, 0x42(sp)              |     t4 = *(var_42h);
    0x0040e218 lw a2, -0x7fe0(gp)            |     a2 = *((gp - 8184));
    0x0040e21c lw a3, -0x7fe0(gp)            |     a3 = *((gp - 8184));
    0x0040e220 lbu v1, 0x43(sp)              |     v1 = *(var_43h);
    0x0040e224 addiu a2, a2, -0x7258         |     a2 += -0x7258;
    0x0040e228 lbu t0, 0x44(sp)              |     t0 = *(var_44h);
    0x0040e22c addiu a3, a3, -0x723c         |     a3 += -0x723c;
    0x0040e230 lbu t1, 0x45(sp)              |     t1 = *(var_45h);
    0x0040e234 lbu t2, 0x46(sp)              |     t2 = *(var_46h);
    0x0040e238 lbu t3, 0x47(sp)              |     t3 = *(var_47h);
    0x0040e23c lw t9, -0x7ccc(gp)            |     t9 = sym.imp.snprintf;
    0x0040e240 sw t4, 0x10(sp)               |     *(var_10h) = t4;
    0x0040e244 sw v1, 0x14(sp)               |     *(var_14h) = v1;
    0x0040e248 sw t0, 0x18(sp)               |     *(var_18h) = t0;
    0x0040e24c sw t1, 0x1c(sp)               |     *(var_1ch) = t1;
    0x0040e250 sw t2, 0x20(sp)               |     *(var_20h) = t2;
    0x0040e254 sw t3, 0x24(sp)               |     *(var_24h) = t3;
    0x0040e258 jalr t9                       |     t9 ();
    0x0040e25c lw gp, 0x28(sp)               |     gp = *(var_28h);
    0x0040e260 lw t9, -0x7fac(gp)            |     t9 = sym.imp.close;
    0x0040e264 move a0, s1                   |     a0 = s1;
                                             |     if (s1 != 0) {
    0x0040e268 bnez s1, 0x40e284             |         goto label_3;
                                             |     }
    0x0040e26c move v0, s0                   |     v0 = s0;
                                             |     do {
                                             | label_0:
    0x0040e270 lw ra, 0x58(sp)               |         ra = *(var_58h);
    0x0040e274 lw s1, 0x54(sp)               |         s1 = *(var_54h);
    0x0040e278 lw s0, 0x50(sp)               |         s0 = *(var_50h);
    0x0040e27c addiu sp, sp, 0x60            |         
    0x0040e280 jr ra                         |         return v0;
                                             | label_3:
    0x0040e284 jalr t9                       |         t9 ();
    0x0040e288 nop                           |         
    0x0040e28c lw gp, 0x28(sp)               |         gp = *(var_28h);
    0x0040e290 move v0, s0                   |         v0 = s0;
    0x0040e294 b 0x40e270                    |         
                                             |     } while (1);
                                             | label_1:
    0x0040e298 lw a0, -0x7fe0(gp)            |     a0 = *((gp - 8184));
    0x0040e29c addiu a0, a0, -0x7260         |     a0 += -0x7260;
    0x0040e2a0 jalr t9                       |     t9 ();
    0x0040e2a4 lw gp, 0x28(sp)               |     gp = *(var_28h);
    0x0040e2a8 move v0, zero                 |     v0 = 0;
    0x0040e2ac b 0x40e270                    |     goto label_0;
                                             | label_2:
    0x0040e2b0 lw v0, -0x7fe0(gp)            |     v0 = *((gp - 8184));
    0x0040e2b4 addiu a0, v0, -0x7268         |     a0 = v0 + -0x7268;
    0x0040e2b8 jalr t9                       |     t9 ();
    0x0040e2bc lw gp, 0x28(sp)               |     gp = *(var_28h);
    0x0040e2c0 move v0, zero                 |     v0 = 0;
    0x0040e2c4 b 0x40e270                    |     goto label_0;
                                             | }
    ; assembly                               | /* r2dec pseudo code output */
                                             | /* /logs/firmware/unblob_extracted/firmware_extract/1180160-3904000.squashfs_v4_le_extract/usr/bin/ushare @ 0x40e2c8 */
                                             | #include <stdint.h>
                                             |  
    ; (fcn) fcn.0040e2c8 ()                  | void fcn_0040e2c8 () {
    0x0040e2c8 lui gp, 5                     |     
    0x0040e2cc addiu gp, gp, 0x48f8          |     
    0x0040e2d0 addu gp, gp, t9               |     gp += t9;
    0x0040e2d4 addiu sp, sp, -0x50           |     
    0x0040e2d8 sw ra, 0x48(sp)               |     *(var_48h) = ra;
    0x0040e2dc sw s1, 0x44(sp)               |     *(var_44h) = s1;
    0x0040e2e0 sw s0, 0x40(sp)               |     *(var_40h) = s0;
    0x0040e2e4 sw gp, 0x18(sp)               |     *(var_18h) = gp;
    0x0040e2e8 move a2, zero                 |     a2 = 0;
    0x0040e2ec move s0, a0                   |     s0 = a0;
    0x0040e2f0 addiu a1, zero, 2             |     a1 = 2;
    0x0040e2f4 lw t9, -0x7d3c(gp)            |     t9 = sym.imp.socket;
    0x0040e2f8 addiu a0, zero, 2             |     a0 = 2;
    0x0040e2fc move v0, zero                 |     v0 = 0;
                                             |     if (s0 == 0) {
    0x0040e300 beqz s0, 0x40e3d4             |         goto label_0;
                                             |     }
    0x0040e304 jalr t9                       |     t9 ();
    0x0040e308 nop                           |     
    0x0040e30c move a1, s0                   |     a1 = s0;
    0x0040e310 lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x0040e314 move s1, v0                   |     s1 = v0;
[31m    0x0040e318 lw t9, -0x7c74(gp)            |     t9 = sym.imp.strcpy;[0m
    0x0040e31c move v1, t9                   |     v1 = t9;
    0x0040e320 lw t9, -0x7d00(gp)            |     t9 = sym.imp.perror;
    0x0040e324 addiu a0, sp, 0x20            |     a0 = sp + 0x20;
                                             |     if (v0 < 0) {
    0x0040e328 bltz v0, 0x40e3e8             |         goto label_1;
                                             |     }
    0x0040e32c move t9, v1                   |     t9 = v1;
    0x0040e330 jalr t9                       |     t9 ();
    0x0040e334 nop                           |     
    0x0040e338 addiu v0, zero, 2             |     v0 = 2;
    0x0040e33c lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x0040e340 ori a1, zero, 0x8915          |     a1 = 0x8915;
    0x0040e344 move a0, s1                   |     a0 = s1;
    0x0040e348 addiu a2, sp, 0x20            |     a2 = sp + 0x20;
    0x0040e34c lw t9, -0x7c7c(gp)            |     t9 = sym.imp.ioctl;
    0x0040e350 sh v0, 0x30(sp)               |     *(var_30h) = v0;
    0x0040e354 jalr t9                       |     t9 ();
    0x0040e358 lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x0040e35c lw t9, -0x7d20(gp)            |     t9 = sym.imp.malloc;
    0x0040e360 move a1, t9                   |     a1 = t9;
    0x0040e364 lw t9, -0x7d00(gp)            |     t9 = sym.imp.perror;
    0x0040e368 addiu a0, zero, 0x10          |     a0 = 0x10;
                                             |     if (v0 < 0) {
    0x0040e36c bltz v0, 0x40e400             |         goto label_2;
                                             |     }
    0x0040e370 move t9, a1                   |     t9 = a1;
    0x0040e374 jalr t9                       |     t9 ();
    0x0040e378 nop                           |     
    0x0040e37c lw a2, 0x34(sp)               |     a2 = *(var_34h);
    0x0040e380 move a0, v0                   |     a0 = v0;
    0x0040e384 lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x0040e388 move s0, v0                   |     s0 = v0;
    0x0040e38c srl t2, a2, 8                 |     t2 = a2 >> 8;
    0x0040e390 andi t0, a2, 0xff             |     t0 = a2 & 0xff;
    0x0040e394 lw a1, -0x7fe0(gp)            |     a1 = *((gp - 8184));
    0x0040e398 andi t1, t2, 0xff             |     t1 = t2 & 0xff;
    0x0040e39c lw t9, -0x7ed0(gp)            |     t9 = sym.imp.sprintf;
    0x0040e3a0 srl a3, a2, 0x10              |     a3 = a2 >> 0x10;
    0x0040e3a4 addiu a1, a1, -0x7cb0         |     a1 += -0x7cb0;
    0x0040e3a8 srl a2, a2, 0x18              |     a2 >>= 0x18;
    0x0040e3ac sw t1, 0x10(sp)               |     *(var_10h) = t1;
    0x0040e3b0 andi a3, a3, 0xff             |     a3 &= 0xff;
    0x0040e3b4 sw t0, 0x14(sp)               |     *(var_14h) = t0;
    0x0040e3b8 jalr t9                       |     t9 ();
    0x0040e3bc lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x0040e3c0 lw t9, -0x7fac(gp)            |     t9 = sym.imp.close;
    0x0040e3c4 move a0, s1                   |     a0 = s1;
    0x0040e3c8 jalr t9                       |     t9 ();
    0x0040e3cc move v0, s0                   |     v0 = s0;
    0x0040e3d0 lw gp, 0x18(sp)               |     gp = *(var_18h);
                                             |     do {
                                             | label_0:
    0x0040e3d4 lw ra, 0x48(sp)               |         ra = *(var_48h);
    0x0040e3d8 lw s1, 0x44(sp)               |         s1 = *(var_44h);
    0x0040e3dc lw s0, 0x40(sp)               |         s0 = *(var_40h);
    0x0040e3e0 addiu sp, sp, 0x50            |         
    0x0040e3e4 jr ra                         |         return v0;
                                             | label_1:
    0x0040e3e8 lw a0, -0x7fe0(gp)            |         a0 = *((gp - 8184));
    0x0040e3ec addiu a0, a0, -0x7260         |         a0 += -0x7260;
    0x0040e3f0 jalr t9                       |         t9 ();
    0x0040e3f4 lw gp, 0x18(sp)               |         gp = *(var_18h);
    0x0040e3f8 move v0, zero                 |         v0 = 0;
    0x0040e3fc b 0x40e3d4                    |         
                                             |     } while (1);
                                             | label_2:
    0x0040e400 lw v1, -0x7fe0(gp)            |     v1 = *((gp - 8184));
    0x0040e404 addiu a0, v1, -0x7268         |     a0 = v1 + -0x7268;
    0x0040e408 jalr t9                       |     t9 ();
    0x0040e40c lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x0040e410 lw t9, -0x7fac(gp)            |     t9 = sym.imp.close;
    0x0040e414 move a0, s1                   |     a0 = s1;
    0x0040e418 jalr t9                       |     t9 ();
    0x0040e41c lw gp, 0x18(sp)               |     gp = *(var_18h);
    0x0040e420 move v0, zero                 |     v0 = 0;
    0x0040e424 b 0x40e3d4                    |     goto label_0;
                                             | }

[*] Function strcpy used 3 times ushare

